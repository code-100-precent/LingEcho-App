<div class="flex grow flex-col gap-y-6 overflow-y-auto overflow-x-hidden border-r border-gray-200 bg-white px-3 pt-5 pb-2 shadow-sm">

<div class="flex h-16 shrink-0 items-center gap-x-3 min-w-0">
    <a href="." class="flex items-center gap-x-3 min-w-0 flex-1 overflow-hidden">
      <template x-if="site.Site.LogoUrl">
        <img class="h-12 w-auto rounded-lg shrink-0" :src="site.Site.LogoUrl" :alt="site.Site.Name" />
      </template>
      <div class="flex flex-col min-w-0 flex-1 overflow-hidden">
        <div class="text-lg font-bold text-gray-800 truncate" x-text="site.Site.Name"></div>
        <div class="text-xs text-gray-500 hidden md:block truncate" x-text="site.Site.Description"></div>
      </div>
    </a>
  </div>

  <nav class="flex flex-1 flex-col min-h-0 overflow-x-hidden">
    <ul role="list" class="flex-1 overflow-y-auto overflow-x-hidden min-h-0">
      <div class="flex flex-col gap-y-7">
        <template x-for="group in navmenus">
          <li x-data="{ open: true }">
            <div @click="open = !open" class="hidden md:flex cursor-pointer items-center justify-between px-2 py-2 text-xs font-semibold uppercase tracking-wider text-gray-400 hover:text-gray-600 min-w-0">
              <span class="truncate flex-1" x-text="group.name"></span>
              <svg class="h-4 w-4 transform transition-transform duration-200" :class="{ '-rotate-90': !open }" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
              </svg>
            </div>
            <ul x-show="open" x-transition:enter="transition-all ease-out duration-300" x-transition:enter-start="opacity-0 -translate-y-2" x-transition:enter-end="opacity-100 translate-y-0" x-transition:leave="transition-all ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" role="list" class="mt-1 space-y-1 overflow-x-hidden">
              <template x-for="item in group.items">
                <li>
                  <a href="#"
                     x-on:click="switchObject($event, item)"
                     class="group flex items-center gap-x-3 rounded-md px-3 py-2 text-sm font-semibold leading-6 transition-all duration-150 border-l-4 border-transparent min-w-0"
                     :class="{
                       'bg-indigo-50 text-indigo-600 border-indigo-600': item.active,
                       'text-gray-700 hover:text-indigo-600 hover:bg-gray-50': !item.active
                     }">

                    <template x-if="item.icon && item.icon.url">
                      <img :src="item.icon.url" :alt="item.icon.alt"
                           class="h-6 w-6 shrink-0 rounded-md object-cover" />
                    </template>

                    <template x-if="item.icon && item.icon.svg">
                      <span x-html="item.icon.svg"
                            class="h-6 w-6 shrink-0"
                            :class="item.active ? 'text-indigo-600' : 'text-gray-400 group-hover:text-indigo-600'"></span>
                    </template>

                    <template x-if="!item.icon">
                      <span
                              class="h-6 w-6 shrink-0 flex items-center justify-center rounded-md border text-xs font-bold"
                              :class="item.active ? 'border-indigo-600 bg-indigo-50 text-indigo-600' : 'text-gray-400 border-gray-200 group-hover:text-indigo-600 group-hover:border-indigo-600'"
                              x-text="item.pluralName[0]"></span>
                    </template>

                    <span class="hidden md:inline truncate" x-text="item.pluralName"></span>
                  </a>
                </li>
              </template>
            </ul>
          </li>
        </template>
      </div>
    </ul>

    <!-- Fixed Bottom Section: User Info & Logout -->
    <div class="shrink-0 border-t border-gray-200 bg-white">
      <!-- User Info & Logout -->
      <div class="-mx-4 px-4 pt-2 pb-2 overflow-x-hidden">
        <div class="flex items-center gap-2">
          <!-- Personal Center (70%) -->
          <a href="#" @click="if(window.adminAppInstance){window.adminAppInstance.showProfile($event);} $event.preventDefault();" class="flex items-center gap-x-2 min-w-0 flex-[0.7] overflow-hidden py-1.5 px-2 rounded-lg hover:bg-gray-50 transition-colors group">
            <template x-if="user.avatar">
              <img class="h-8 w-8 rounded-full bg-gray-100 border-2 border-gray-200 object-cover shrink-0 group-hover:border-indigo-300 transition-colors" :src="user.avatar" alt="" />
            </template>
            <template x-if="!user.avatar">
              <span
                      class="uppercase h-8 w-8 flex items-center justify-center rounded-full bg-gradient-to-br from-indigo-100 to-purple-100 text-indigo-700 border-2 border-indigo-200 font-bold text-sm shrink-0 group-hover:border-indigo-400 group-hover:from-indigo-200 group-hover:to-purple-200 transition-colors"
                      x-text="user.name[0]"></span>
            </template>
            <div class="hidden md:block min-w-0 flex-1 overflow-hidden">
              <div class="text-xs font-semibold text-gray-800 truncate group-hover:text-indigo-600 transition-colors" x-text="user.name"></div>
            </div>
          </a>
          <!-- Logout (30%) -->
          <a href="/api/auth/logout?next=/api/auth/login"
             class="flex items-center justify-center gap-x-1.5 flex-[0.3] py-1.5 px-2 rounded-lg hover:bg-red-50 text-gray-500 hover:text-red-600 transition-colors duration-200"
             title="Logout">
            <svg xmlns="http://www.w3.org/2000/svg"
                 fill="none"
                 viewBox="0 0 24 24"
                 stroke-width="1.8"
                 stroke="currentColor"
                 class="w-4 h-4">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9" />
            </svg>
            <span class="hidden md:inline text-xs font-medium">退出</span>
          </a>
        </div>
      </div>
    </div>
  </nav>
</div>
